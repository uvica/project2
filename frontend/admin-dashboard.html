<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TalentConnect CareerCraft - Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gray: {
                            900: '#111827',
                            800: '#1f2937',
                            700: '#374151',
                            600: '#4b5563',
                            500: '#6b7280',
                            400: '#9ca3af'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Admin Dashboard Styles */
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        /* Enhanced Sidebar */
        .sidebar-item { 
            padding: 0.75rem 1rem; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 0.5rem;
            margin: 0.25rem 0;
            display: flex;
            align-items: center;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        .sidebar-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        .sidebar-item.active { 
            background: linear-gradient(135deg, #3b82f6, #1d4ed8); 
            color: white; 
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        .sidebar-item.active::before {
            transform: scaleY(1);
        }
        .sidebar-item:hover { 
            background-color: #374151; 
            transform: translateX(4px);
        }
        
        /* Enhanced Form Elements */
        .form-input, .form-textarea { 
            background-color: #374151; 
            border: 2px solid #4b5563; 
            color: white; 
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            width: 100%;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
        }
        .form-textarea { min-height: 120px; resize: vertical; }
        .form-input:focus, .form-textarea:focus { 
            border-color: #3b82f6; 
            outline: none; 
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        /* Enhanced Buttons */
        .btn-primary { 
            background: linear-gradient(135deg, #3b82f6, #1d4ed8); 
            color: white; 
            padding: 0.75rem 1.5rem; 
            border-radius: 0.5rem; 
            border: none; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        .btn-primary:hover { 
            background: linear-gradient(135deg, #2563eb, #1e40af); 
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        .btn-primary:active {
            transform: translateY(0);
            transition: all 0.1s ease;
        }
        
        .btn-secondary { 
            background: linear-gradient(135deg, #6b7280, #4b5563); 
            color: white; 
            padding: 0.75rem 1.5rem; 
            border-radius: 0.5rem; 
            border: none; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
        }
        .btn-secondary:hover { 
            background: linear-gradient(135deg, #4b5563, #374151); 
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(107, 114, 128, 0.3);
        }
        
        .btn-danger { 
            background: linear-gradient(135deg, #ef4444, #dc2626); 
            color: white; 
            padding: 0.75rem 1.5rem; 
            border-radius: 0.5rem; 
            border: none; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
        }
        .btn-danger:hover { 
            background: linear-gradient(135deg, #dc2626, #b91c1c); 
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);
        }
        
        /* Enhanced Cards with Glassmorphism */
        .card { 
            background: rgba(31, 41, 55, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 1rem; 
            padding: 2rem; 
            margin-bottom: 1.5rem; 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 255, 255, 0.2);
            background: rgba(31, 41, 55, 0.9);
        }
        
        /* Enhanced Modals */
        .modal { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.7); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            z-index: 1000; 
            backdrop-filter: blur(5px);
        }
        .modal-content { 
            background: rgba(31, 41, 55, 0.9);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            padding: 2.5rem; 
            border-radius: 1rem; 
            max-width: 90vw; 
            max-height: 90vh; 
            overflow-y: auto; 
            width: 100%; 
            max-width: 600px; 
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.4);
            animation: modalSlideIn 0.3s ease-out;
            position: relative;
        }
        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
            border-radius: 1rem;
            pointer-events: none;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .admin-hidden { display: none !important; }
        
        /* Enhanced Item Rows */
        .item-row { 
            background: linear-gradient(135deg, #374151, #2d3748); 
            padding: 1.5rem; 
            border-radius: 0.75rem; 
            margin-bottom: 1rem; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #4b5563;
        }
        .item-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #6b7280;
        }
        
        /* Enhanced Stat Cards with Glassmorphism */
        .stat-card {
            background: rgba(31, 41, 55, 0.7);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
        }
        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }
        .stat-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            background: rgba(31, 41, 55, 0.8);
            border-color: rgba(255, 255, 255, 0.15);
        }
        
        /* Enhanced Login Screen */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #111827 0%, #1f2937 50%, #111827 100%);
            position: relative;
            overflow: hidden;
        }
        .login-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-20px, -20px) rotate(180deg); }
        }
        
        .login-form {
            background: linear-gradient(135deg, #1f2937, #111827);
            padding: 3rem;
            border-radius: 1rem;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            border: 1px solid #374151;
            position: relative;
            z-index: 1;
            animation: loginSlideIn 0.6s ease-out;
        }
        
        @keyframes loginSlideIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Enhanced Tables */
        .user-table {
            width: 100%;
            border-collapse: collapse;
            background: linear-gradient(135deg, #1f2937, #111827);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        .user-table th, .user-table td {
            padding: 1.25rem;
            text-align: left;
            border-bottom: 1px solid #374151;
        }
        .user-table th {
            background: linear-gradient(135deg, #374151, #2d3748);
            font-weight: 700;
            color: #f9fafb;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
        }
        .user-table tr {
            transition: all 0.3s ease;
        }
        .user-table tr:hover {
            background: linear-gradient(135deg, #2d3748, #374151);
            transform: scale(1.01);
        }
        
        /* Enhanced Input Groups */
        .input-group {
            position: relative;
            margin-bottom: 1.5rem;
        }
        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #f9fafb;
        }
        .input-group .form-input {
            padding-left: 3rem;
        }
        .input-group .icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            z-index: 1;
        }
        
        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #3b82f6;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Notification Styles */
        .notification {
            background: linear-gradient(135deg, #1f2937, #111827);
            border: 1px solid #374151;
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            min-width: 300px;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateX(100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
        }
        
        .notification.success::before {
            background: linear-gradient(90deg, #10b981, #059669);
        }
        
        .notification.error::before {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }
        
        .notification.warning::before {
            background: linear-gradient(90deg, #f59e0b, #d97706);
        }
        
        .notification-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        
        .notification.success .notification-icon {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .notification.error .notification-icon {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        
        .notification.warning .notification-icon {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        
        .notification.info .notification-icon {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                min-height: auto;
            }
            .modal-content {
                margin: 1rem;
                padding: 1.5rem;
            }
            .login-form {
                margin: 1rem;
                padding: 2rem;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-900 text-white">
    <!-- Admin Login Screen -->
    <div id="adminLoginScreen" class="login-container">
        <div class="login-form">
            <div class="text-center mb-8">
                <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl mb-6 shadow-lg">
                    <i class="fas fa-shield-alt text-white text-3xl"></i>
                </div>
                <h2 class="text-3xl font-bold bg-gradient-to-r from-blue-400 to-blue-600 bg-clip-text text-transparent">Admin Portal</h2>
                <p class="text-gray-400 mt-3 text-lg">TalentConnect CareerCraft</p>
                <p class="text-gray-500 mt-2">Enter your credentials to access the dashboard</p>
            </div>
            <form id="adminLoginForm" class="space-y-6">
                <div class="input-group">
                    <label class="block text-sm font-semibold mb-3 text-gray-200">Admin Email</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none">
                            <i class="fas fa-envelope text-gray-400"></i>
                        </div>
                        <input type="email" id="adminEmail" required class="form-input pl-12 py-4 text-lg" placeholder="admin@talentconnect.com" />
                    </div>
                </div>
                <div class="input-group">
                    <label class="block text-sm font-semibold mb-3 text-gray-200">Password</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none">
                            <i class="fas fa-lock text-gray-400"></i>
                        </div>
                        <input type="password" id="adminPassword" required class="form-input pl-12 py-4 text-lg" placeholder="Enter your password" />
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <label class="flex items-center cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500 focus:ring-2" />
                        <span class="ml-3 text-sm font-medium text-gray-300">Remember me</span>
                    </label>
                    <a href="#" class="text-sm text-blue-400 hover:text-blue-300 font-medium transition-colors">Forgot password?</a>
                </div>
                <div class="space-y-4">
                    <button type="submit" class="btn-primary w-full py-4 text-lg font-semibold flex items-center justify-center">
                        <i class="fas fa-sign-in-alt mr-3"></i> 
                        <span>Access Dashboard</span>
                    </button>
                    <a href="index.html" class="btn-secondary w-full py-4 text-lg font-semibold flex items-center justify-center text-center">
                        <i class="fas fa-arrow-left mr-3"></i> 
                        <span>Back to Website</span>
                    </a>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="admin-hidden min-h-screen flex">
        <!-- Enhanced Sidebar -->
        <div class="sidebar w-72 min-h-screen bg-gradient-to-b from-gray-800 to-gray-900 p-6 border-r border-gray-700">
            <div class="mb-8">
                <div class="flex items-center mb-4">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mr-3">
                        <i class="fas fa-cog text-white text-lg"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-white">Admin Panel</h2>
                        <p class="text-sm text-gray-400">TalentConnect CareerCraft</p>
                    </div>
                </div>
                <div class="h-px bg-gradient-to-r from-blue-500 to-transparent"></div>
            </div>
            <nav class="space-y-2">
                <a href="index.html" class="sidebar-item group">
                    <i class="fas fa-home mr-3 text-gray-400 group-hover:text-white transition-colors"></i> 
                    <span>Home</span>
                </a>
                <div class="sidebar-item active group" onclick="showTab('overview', event)">
                    <i class="fas fa-chart-pie mr-3 text-blue-400"></i>
                    <span>Overview</span>
                </div>
                <div class="sidebar-item group" onclick="showTab('siteStats', event)">
                    <i class="fas fa-cogs mr-3 text-gray-400 group-hover:text-white transition-colors"></i>
                    <span>Site Stats</span>
                </div>
                <div class="sidebar-item group" onclick="showTab('courses', event)">
                    <i class="fas fa-book mr-3 text-gray-400 group-hover:text-white transition-colors"></i>
                    <span>Courses</span>
                </div>
                <div class="sidebar-item group" onclick="showTab('partners', event)">
                    <i class="fas fa-handshake mr-3 text-gray-400 group-hover:text-white transition-colors"></i>
                    <span>Hiring Partners</span>
                </div>
                <div class="sidebar-item group" onclick="showTab('stories', event)">
                    <i class="fas fa-star mr-3 text-gray-400 group-hover:text-white transition-colors"></i>
                    <span>Success Stories</span>
                </div>
                <div class="sidebar-item group" onclick="showTab('users', event)">
                    <i class="fas fa-users mr-3 text-gray-400 group-hover:text-white transition-colors"></i>
                    <span>Registered Users</span>
                </div>
                <div class="sidebar-item group" onclick="showTab('consultations', event)">
                    <i class="fas fa-calendar-check mr-3 text-gray-400 group-hover:text-white transition-colors"></i>
                    <span>Expert Meetings</span>
                </div>
                <div class="mt-8 pt-4 border-t border-gray-700">
                    <div class="sidebar-item group text-red-400 hover:bg-red-500/10" onclick="logout()">
                        <i class="fas fa-sign-out-alt mr-3"></i>
                        <span>Logout</span>
                    </div>
                </div>
            </nav>
        </div>

        <!-- Enhanced Main Content -->
        <div class="flex-1 p-8 overflow-y-auto bg-gradient-to-br from-gray-900 via-gray-900 to-gray-800">
            <div class="mb-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-400 to-blue-600 bg-clip-text text-transparent mb-2">Welcome Back, Admin</h1>
                        <p class="text-gray-400 text-lg">Manage and monitor your TalentConnect platform</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-right">
                            <p class="text-sm text-gray-500">Last updated</p>
                            <p class="text-sm font-medium text-gray-300" id="lastUpdated">Just now</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center">
                            <i class="fas fa-check text-white"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Overview -->
            <div id="overview" class="tab-content active">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="stat-card group">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-book text-white text-xl"></i>
                            </div>
                            <i class="fas fa-arrow-up text-green-400 text-sm"></i>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-400 mb-2">Total Courses</h3>
                        <p class="text-3xl font-bold text-blue-400" id="totalCourses">0</p>
                        <p class="text-xs text-gray-500 mt-2">Active courses</p>
                    </div>
                    <div class="stat-card group">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-handshake text-white text-xl"></i>
                            </div>
                            <i class="fas fa-arrow-up text-green-400 text-sm"></i>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-400 mb-2">Hiring Partners</h3>
                        <p class="text-3xl font-bold text-yellow-400" id="totalPartners">0</p>
                        <p class="text-xs text-gray-500 mt-2">Active partnerships</p>
                    </div>
                    <div class="stat-card group">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-star text-white text-xl"></i>
                            </div>
                            <i class="fas fa-arrow-up text-green-400 text-sm"></i>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-400 mb-2">Success Stories</h3>
                        <p class="text-3xl font-bold text-purple-400" id="totalStories">0</p>
                        <p class="text-xs text-gray-500 mt-2">Student testimonials</p>
                    </div>
                    <div class="stat-card group">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-users text-white text-xl"></i>
                            </div>
                            <i class="fas fa-arrow-up text-green-400 text-sm"></i>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-400 mb-2">Registered Users</h3>
                        <p class="text-3xl font-bold text-green-400" id="totalUsers">0</p>
                        <p class="text-xs text-gray-500 mt-2">Total registrations</p>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="card">
                    <h3 class="text-xl font-bold mb-6 text-white">Quick Actions</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button onclick="showTab('courses', event)" class="p-4 bg-gradient-to-r from-blue-500/10 to-blue-600/10 border border-blue-500/20 rounded-lg hover:from-blue-500/20 hover:to-blue-600/20 transition-all duration-300 group">
                            <i class="fas fa-plus text-blue-400 text-2xl mb-2"></i>
                            <h4 class="font-semibold text-white group-hover:text-blue-300">Add New Course</h4>
                            <p class="text-sm text-gray-400">Create a new course offering</p>
                        </button>
                        <button onclick="showTab('partners', event)" class="p-4 bg-gradient-to-r from-yellow-500/10 to-yellow-600/10 border border-yellow-500/20 rounded-lg hover:from-yellow-500/20 hover:to-yellow-600/20 transition-all duration-300 group">
                            <i class="fas fa-building text-yellow-400 text-2xl mb-2"></i>
                            <h4 class="font-semibold text-white group-hover:text-yellow-300">Add Partner</h4>
                            <p class="text-sm text-gray-400">Add new hiring partner</p>
                        </button>
                        <button onclick="showTab('stories', event)" class="p-4 bg-gradient-to-r from-purple-500/10 to-purple-600/10 border border-purple-500/20 rounded-lg hover:from-purple-500/20 hover:to-purple-600/20 transition-all duration-300 group">
                            <i class="fas fa-quote-left text-purple-400 text-2xl mb-2"></i>
                            <h4 class="font-semibold text-white group-hover:text-purple-300">Add Success Story</h4>
                            <p class="text-sm text-gray-400">Add student testimonial</p>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Enhanced Site Stats Tab -->
            <div id="siteStats" class="tab-content">
                <div class="card">
                    <div class="flex items-center mb-6">
                        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-cogs text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-white">Site Statistics</h2>
                            <p class="text-gray-400">Manage website statistics and metrics</p>
                        </div>
                    </div>
                    <form id="siteStatsForm" class="space-y-8">
                        <!-- Program Information -->
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-white border-b border-gray-700 pb-2">Program Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="input-group">
                                    <label for="program_duration" class="block text-sm font-semibold text-gray-200 mb-2">Program Duration</label>
                                    <input type="text" id="program_duration" name="program_duration" class="form-input" placeholder="e.g., 3 Months">
                                </div>
                                <div class="input-group">
                                    <label for="course_tracks" class="block text-sm font-semibold text-gray-200 mb-2">Course Tracks</label>
                                    <input type="text" id="course_tracks" name="course_tracks" class="form-input" placeholder="e.g., 8+">
                                </div>
                                <div class="input-group">
                                    <label for="placement_rate" class="block text-sm font-semibold text-gray-200 mb-2">Placement Rate</label>
                                    <input type="text" id="placement_rate" name="placement_rate" class="form-input" placeholder="e.g., 100%">
                                </div>
                                <div class="input-group">
                                    <label for="industry_mentors" class="block text-sm font-semibold text-gray-200 mb-2">Industry Mentors</label>
                                    <input type="text" id="industry_mentors" name="industry_mentors" class="form-input" placeholder="e.g., 50+">
                                </div>
                            </div>
                        </div>

                        <!-- Financial Information -->
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-white border-b border-gray-700 pb-2">Financial Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="input-group">
                                    <label for="min_stipend" class="block text-sm font-semibold text-gray-200 mb-2">Minimum Stipend</label>
                                    <input type="text" id="min_stipend" name="min_stipend" class="form-input" placeholder="e.g., ₹15K">
                                </div>
                                <div class="input-group">
                                    <label for="max_stipend" class="block text-sm font-semibold text-gray-200 mb-2">Maximum Stipend</label>
                                    <input type="text" id="max_stipend" name="max_stipend" class="form-input" placeholder="e.g., ₹35K">
                                </div>
                                <div class="input-group">
                                    <label for="avg_package" class="block text-sm font-semibold text-gray-200 mb-2">Average Package</label>
                                    <input type="text" id="avg_package" name="avg_package" class="form-input" placeholder="e.g., ₹12.5L">
                                </div>
                                <div class="input-group">
                                    <label for="highest_package" class="block text-sm font-semibold text-gray-200 mb-2">Highest Package</label>
                                    <input type="text" id="highest_package" name="highest_package" class="form-input" placeholder="e.g., ₹45L">
                                </div>
                                <div class="input-group">
                                    <label for="average_starting_salary" class="block text-sm font-semibold text-gray-200 mb-2">Average Starting Salary</label>
                                    <input type="text" id="average_starting_salary" name="average_starting_salary" class="form-input" placeholder="e.g., ₹8.5L">
                                </div>
                                <div class="input-group">
                                    <label for="internship_stipend" class="block text-sm font-semibold text-gray-200 mb-2">Internship Stipend</label>
                                    <input type="text" id="internship_stipend" name="internship_stipend" class="form-input" placeholder="e.g., ₹15K-₹35K">
                                </div>
                            </div>
                        </div>

                        <!-- Success Metrics -->
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-white border-b border-gray-700 pb-2">Success Metrics</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="input-group">
                                    <label for="success_rate" class="block text-sm font-semibold text-gray-200 mb-2">Success Rate</label>
                                    <input type="text" id="success_rate" name="success_rate" class="form-input" placeholder="e.g., 95%">
                                </div>
                                <div class="input-group">
                                    <label for="job_placement_guarantee" class="block text-sm font-semibold text-gray-200 mb-2">Job Placement Guarantee</label>
                                    <input type="text" id="job_placement_guarantee" name="job_placement_guarantee" class="form-input" placeholder="e.g., 100%">
                                </div>
                                <div class="input-group">
                                    <label for="internship_placement" class="block text-sm font-semibold text-gray-200 mb-2">Internship Placement</label>
                                    <input type="text" id="internship_placement" name="internship_placement" class="form-input" placeholder="e.g., 100%">
                                </div>
                                <div class="input-group">
                                    <label for="convert_to_full_time" class="block text-sm font-semibold text-gray-200 mb-2">Convert to Full-time</label>
                                    <input type="text" id="convert_to_full_time" name="convert_to_full_time" class="form-input" placeholder="e.g., 85%">
                                </div>
                                <div class="input-group">
                                    <label for="avg_job_placement_time" class="block text-sm font-semibold text-gray-200 mb-2">Avg. Job Placement Time</label>
                                    <input type="text" id="avg_job_placement_time" name="avg_job_placement_time" class="form-input" placeholder="e.g., 2 Weeks">
                                </div>
                                <div class="input-group">
                                    <label for="average_rating" class="block text-sm font-semibold text-gray-200 mb-2">Average Rating</label>
                                    <input type="text" id="average_rating" name="average_rating" class="form-input" placeholder="e.g., 4.9/5">
                                </div>
                            </div>
                        </div>

                        <!-- Network & Projects -->
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-white border-b border-gray-700 pb-2">Network & Projects</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="input-group">
                                    <label for="alumni_network" class="block text-sm font-semibold text-gray-200 mb-2">Alumni Network</label>
                                    <input type="text" id="alumni_network" name="alumni_network" class="form-input" placeholder="e.g., 500+">
                                </div>
                                <div class="input-group">
                                    <label for="active_alumni_network" class="block text-sm font-semibold text-gray-200 mb-2">Active Alumni Network</label>
                                    <input type="text" id="active_alumni_network" name="active_alumni_network" class="form-input" placeholder="e.g., 500+">
                                </div>
                                <div class="input-group">
                                    <label for="partner_companies" class="block text-sm font-semibold text-gray-200 mb-2">Partner Companies</label>
                                    <input type="text" id="partner_companies" name="partner_companies" class="form-input" placeholder="e.g., 200+">
                                </div>
                                <div class="input-group">
                                    <label for="hands_on_projects" class="block text-sm font-semibold text-gray-200 mb-2">Hands-on Projects</label>
                                    <input type="text" id="hands_on_projects" name="hands_on_projects" class="form-input" placeholder="e.g., 25+">
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-end pt-6 border-t border-gray-700">
                            <button type="submit" class="btn-primary px-8 py-3 text-lg">
                                <i class="fas fa-save mr-2"></i>
                                Save All Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Enhanced Courses Tab -->
            <div id="courses" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-book text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-white">Course Management</h2>
                                <p class="text-gray-400">Manage your course offerings</p>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="openCourseModal()">
                            <i class="fas fa-plus mr-2"></i>
                            Add New Course
                        </button>
                    </div>
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Icon</th>
                                <th>Title</th>
                                <th>Description</th>
                                <th>Duration</th>
                                <th>Level</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="courseList"></tbody>
                    </table>
                </div>
            </div>

            <!-- Enhanced Partners Tab -->
            <div id="partners" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-handshake text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-white">Hiring Partners</h2>
                                <p class="text-gray-400">Manage your hiring partner network</p>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="openPartnerModal()">
                            <i class="fas fa-plus mr-2"></i>
                            Add New Partner
                        </button>
                    </div>
                    <div id="partnerList"></div>
                </div>
            </div>

            <!-- Enhanced Success Stories Tab -->
            <div id="stories" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-star text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-white">Success Stories</h2>
                                <p class="text-gray-400">Manage student testimonials and success stories</p>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="openStoryModal()">
                            <i class="fas fa-plus mr-2"></i>
                            Add New Story
                        </button>
                    </div>
                    <div id="storyList"></div>
                </div>
            </div>

            <!-- Enhanced Registered Users Tab -->
            <div id="users" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-users text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-white">Registered Users</h2>
                                <p class="text-gray-400">View and manage user registrations</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="text-right">
                                <p class="text-sm text-gray-500">Total Users</p>
                                <p class="text-lg font-bold text-green-400" id="totalUsersDisplay">0</p>
                            </div>
                        </div>
                    </div>
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Phone</th>
                                <th>CV</th>
                            </tr>
                        </thead>
                        <tbody id="userList"></tbody>
                    </table>
                </div>
            </div>

            <!-- Expert Meetings Tab -->
            <div id="consultations" class="tab-content">
                <div class="card">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mr-4">
                                <i class="fas fa-calendar-check text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-white">Expert Meetings</h2>
                                <p class="text-gray-400">View and manage consultation bookings</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="text-right">
                                <p class="text-sm text-gray-500">Total Bookings</p>
                                <p class="text-lg font-bold text-purple-400" id="totalConsultations">0</p>
                            </div>
                        </div>
                    </div>
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Meeting Date</th>
                                <th>Time Slot</th>
                                <th>Status</th>
                                <th>Booked On</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="consultationList"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Course Modal -->
    <div id="courseModal" class="modal admin-hidden">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4">Add/Edit Course</h2>
            <form id="courseForm" class="space-y-4">
                <input type="hidden" id="courseId">
                <div>
                    <label class="block text-sm font-medium mb-2">Icon (Emoji)</label>
                    <input type="text" id="courseIcon" class="form-input" placeholder="e.g., ⚛️" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Title</label>
                    <input type="text" id="courseTitle" required class="form-input" placeholder="Course Title" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Description</label>
                    <textarea id="courseDescription" class="form-textarea" placeholder="Short description"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Duration</label>
                    <input type="text" id="courseDuration" class="form-input" placeholder="e.g., 3 months" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Level</label>
                    <input type="text" id="courseLevel" class="form-input" placeholder="e.g., Intermediate" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Full Description</label>
                    <textarea id="courseFullDescription" class="form-textarea" placeholder="Detailed description"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Features (one per line)</label>
                    <textarea id="courseFeatures" class="form-textarea" placeholder="Feature 1\nFeature 2\nFeature 3"></textarea>
                </div>
                <button type="submit" class="btn-primary w-full">Save Course</button>
                <button type="button" class="btn-secondary w-full mt-2" onclick="closeCourseModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Partner Modal -->
    <div id="partnerModal" class="modal admin-hidden">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4">Add/Edit Partner</h2>
            <form id="partnerForm" enctype="multipart/form-data" class="space-y-4">
                <input type="hidden" id="partnerIndex">
                <div>
                    <label class="block text-sm font-medium mb-2">Name (Alt Text)</label>
                    <input type="text" id="partnerAlt" name="name" required class="form-input" placeholder="Enter partner name" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Logo Image</label>
                    <input type="file" id="partnerSrc" name="logo" accept="image/*" required class="form-input" />
                </div>
                <button type="submit" class="btn-primary w-full">Save Partner</button>
                <button type="button" class="btn-secondary w-full mt-2" onclick="closePartnerModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Story Modal -->
    <div id="storyModal" class="modal admin-hidden">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4">Add/Edit Success Story</h2>
            <form id="storyForm" class="space-y-4">
                <input type="hidden" id="storyIndex">
                <div>
                    <label class="block text-sm font-medium mb-2">Quote</label>
                    <textarea id="storyQuote" required class="form-textarea" placeholder="Success quote"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Name</label>
                    <input type="text" id="storyName" required class="form-input" placeholder="Alumni Name" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Role</label>
                    <input type="text" id="storyRole" required class="form-input" placeholder="Job Role" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Company</label>
                    <input type="text" id="storyCompany" required class="form-input" placeholder="Company Name" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Upload Image</label>
                    <input type="file" id="storyImageFile" class="form-input" accept="image/*" />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Rating (1-5)</label>
                    <input type="number" id="storyRating" required min="1" max="5" class="form-input" />
                </div>
                <button type="submit" class="btn-primary w-full">Save Story</button>
                <button type="button" class="btn-secondary w-full mt-2" onclick="closeStoryModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- CV Preview Modal -->
    <div id="cvPreviewModal" class="modal admin-hidden">
        <div class="modal-content" style="max-width: 90vw; max-height: 90vh; width: 1000px;">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-white" id="cvPreviewTitle">CV Preview</h3>
                <button onclick="closeCVPreview()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>
            <div class="bg-gray-800 rounded-lg p-4 h-96 md:h-[600px]">
                <iframe 
                    id="cvPreviewFrame" 
                    class="w-full h-full border-0 rounded-lg bg-white"
                    src=""
                    title="CV Preview">
                </iframe>
                <div id="cvPreviewError" class="hidden text-center text-gray-400 py-8">
                    <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                    <p>Unable to preview this CV format.</p>
                    <p class="text-sm mt-2">Try downloading the file instead.</p>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-4">
                <button onclick="closeCVPreview()" class="btn-secondary">Close</button>
                <button id="cvDownloadFromPreview" onclick="" class="btn-primary">
                    <i class="fas fa-download mr-2"></i>Download CV
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="fixed top-4 right-4 z-50 space-y-2">
        <!-- Notifications will be added here dynamically -->
    </div>

    <script>
// ----------------- API Configuration -----------------
const API_BASE = "https://talentconnects.onrender.com"; // Production backend URL

async function debugCourses() {
  try {
    // ✅ Corrected endpoint with /api prefix
    const res = await fetch(`${API_BASE}/api/courses`, { cache: "no-cache" });
    console.log("Fetch response object:", res);

    if (!res.ok) {
      console.error("HTTP error! Status:", res.status);
      const text = await res.text();
      console.error("Response text:", text);
      return;
    }

    const data = await res.json();
    console.log("Courses data from backend:", data);
  } catch (err) {
    console.error("Fetch failed:", err);
  }
}


        // --- ADMIN LOGIN ---
        document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            if (email === 'admin@talentconnect.com' && password === 'admin123') {
                showAdminPanel();
            } else {
                const form = document.getElementById('adminLoginForm');
                form.classList.add('shake');
                setTimeout(() => form.classList.remove('shake'), 500);
                alert('Invalid credentials. Please try again.');
            }
        });

        function showAdminPanel() {
            document.getElementById('adminLoginScreen').classList.add('admin-hidden');
            document.getElementById('adminDashboard').classList.remove('admin-hidden');
            loadAllData();
            
            // Show welcome notification
            showNotification('Welcome to Admin Dashboard!', 'success');
            
            // Start monitoring for new registrations
            checkForNewRegistrations(); // Initial check
            setInterval(checkForNewRegistrations, 30000); // Check every 30 seconds
        }

        // --- LOGOUT ---
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                document.getElementById('adminDashboard').classList.add('admin-hidden');
                document.getElementById('adminLoginScreen').classList.remove('admin-hidden');
                document.getElementById('adminLoginForm').reset();
            }
        }

        // --- TABS ---
        function showTab(tab, event) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            if (event) event.currentTarget.classList.add('active');
            if (tab === 'users') fetchUsers();
            if (tab === 'courses') loadCourses();
            if (tab === 'partners') loadPartners();
            if (tab === 'stories') loadStories();
            if (tab === 'siteStats') loadSiteStats();
            if (tab === 'consultations') loadConsultations();
        }

        // --- LOAD DATA ---
        async function loadAllData() {
            await fetchUsers();
            await loadCourses();
            await loadPartners();
            await loadStories();
            await loadSiteStats();
            await loadConsultations();
        }


// --- SITE STATS ---
async function loadSiteStats() {
  try {
    const res = await fetch(`${API_BASE}/api/site_stats`); // added /api
    if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
    const data = await res.json();
    console.log("Site stats data:", data);

    // Update ALL form fields including the ones you added
    const fieldMappings = {
      'program_duration': data.program_duration || '3 Months',
      'course_tracks': data.course_tracks || '8+',
      'placement_rate': data.placement_rate || '100%',
      'industry_mentors': data.industry_mentors || '50+',
      'min_stipend': data.min_stipend || '₹15K',
      'max_stipend': data.max_stipend || '₹35K',
      'alumni_network': data.alumni_network || '500+',
      'partner_companies': data.partner_companies || '200+',
      'average_rating': data.average_rating || '4.9/5',
      'avg_package': data.avg_package || '₹12.5L',
      'highest_package': data.highest_package || '₹45L',
      'success_rate': data.success_rate || '95%',
      'hands_on_projects': data.hands_on_projects || '25+',
      'job_placement_guarantee': data.job_placement_guarantee || '100%',
      'active_alumni_network': data.active_alumni_network || '500+',
      'internship_placement': data.internship_placement || '100%',
      'convert_to_full_time': data.convert_to_full_time || '85%',
      'avg_job_placement_time': data.avg_job_placement_time || '2 Weeks',
      'average_starting_salary': data.average_starting_salary || '₹8.5L',
      'internship_stipend': data.internship_stipend || '₹15K-₹35K'
    };

    // Update all form fields
    for (const [fieldId, value] of Object.entries(fieldMappings)) {
      const element = document.getElementById(fieldId);
      if (element) {
        element.value = value;
      } else {
        console.warn(`Element with ID ${fieldId} not found`);
      }
    }

  } catch (err) {
    console.error('Error loading site stats:', err);
    alert(`Failed to load site stats: ${err.message}. Check console for details.`);
  }
}


// FIXED FORM SUBMISSION HANDLER
document.getElementById('siteStatsForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Collect all form data properly
    const formData = new FormData(this);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting data:', data); // Debug log

    try {
          const res = await fetch(`${API_BASE}/api/site_stats`, { // ✅ fixed: added /api

            method: 'POST',
            headers: { 
                'Content-Type': 'application/json' 
            },
            body: JSON.stringify(data)
        });
        
        const responseData = await res.json();
        
        if (!res.ok) {
            throw new Error(responseData.error || `Server returned ${res.status}`);
        }
        
        alert(responseData.message || 'Site stats updated successfully!');
        loadSiteStats(); // Reload to reflect changes
    } catch (err) {
        console.error('Error updating site stats:', err);
        alert(`Failed to update site stats: ${err.message}`);
    }
});

       
    // --- COURSES ---
async function loadCourses() {
    try {
        console.log('Loading courses...');
        const res = await fetch(`${API_BASE}/api/courses`);
        if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
        
        const courses = await res.json();
        console.log('Courses loaded:', courses.length);
        
        renderCourses(courses);
        document.getElementById('totalCourses').innerText = courses.length;
    } catch(err) {
        console.error('Error loading courses:', err);
        const container = document.getElementById('courseList');
        if (container) {
            container.innerHTML = '<tr><td colspan="6" class="text-red-400">Error loading courses</td></tr>';
        }
    }
}

// --- PARTNERS ---
async function loadPartners() {
    try {
        console.log('Loading partners...');
        const res = await fetch(`${API_BASE}/api/partners`);

        if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
        
        const partners = await res.json();
        console.log('Partners loaded:', partners.length);
        
        renderPartners(partners);
        document.getElementById('totalPartners').innerText = partners.length;
    } catch(err) { 
        console.error('Error loading partners:', err);
        const container = document.getElementById('partnerList');
        if (container) {
            container.innerHTML = '<p class="text-red-400 p-4">Error loading partners. Check console for details.</p>';
        }
    }
}
// --- SUCCESS STORIES ---  
async function loadStories() {
    try {
        console.log('Loading stories...');
        const res = await fetch(`${API_BASE}/api/success_stories`);

        if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
        
        const stories = await res.json();
        console.log('Stories loaded:', stories.length);
        
        renderStories(stories);
        document.getElementById('totalStories').innerText = stories.length;
    } catch(err) { 
        console.error('Error loading stories:', err);
        const container = document.getElementById('storyList');
        if (container) {
            container.innerHTML = '<p class="text-red-400">Error loading stories</p>';
        }
    }
}

        function openCourseModal(course = null) {
            const modal = document.getElementById('courseModal');
            modal.classList.remove('admin-hidden');
            if (course) {
                document.getElementById('courseId').value = course.id;
                document.getElementById('courseIcon').value = course.icon || '';
                document.getElementById('courseTitle').value = course.title || '';
                document.getElementById('courseDescription').value = course.description || '';
                document.getElementById('courseDuration').value = course.duration || '';
                document.getElementById('courseLevel').value = course.level || '';
                document.getElementById('courseFullDescription').value = course.full_description || '';
                document.getElementById('courseFeatures').value = course.features || '';
            } else {
                document.getElementById('courseForm').reset();
                document.getElementById('courseId').value = '';
            }
        }

        function closeCourseModal() { 
            document.getElementById('courseModal').classList.add('admin-hidden'); 
        }

        document.getElementById('courseForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const id = document.getElementById('courseId').value;
            const courseData = {
                icon: document.getElementById('courseIcon').value || null,
                title: document.getElementById('courseTitle').value,
                description: document.getElementById('courseDescription').value || null,
                duration: document.getElementById('courseDuration').value || null,
                level: document.getElementById('courseLevel').value || null,
                full_description: document.getElementById('courseFullDescription').value || null,
                features: document.getElementById('courseFeatures').value || null
            };
            try {
               const response = await fetch(
  id ? `${API_BASE}/api/courses/${id}` : `${API_BASE}/api/courses`,
  {
                    method: id ? 'PUT' : 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(courseData)
                });
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                closeCourseModal();
                loadCourses();
            } catch(err) { 
                console.error('Error saving course:', err);
                alert(`Failed to save course: ${err.message}`);
            }
        });





       function renderCourses(courses) {
    const container = document.getElementById('courseList');
    if (!container) return;
    
    // Clear previous content
    container.innerHTML = '';
    
    if (courses.length === 0) {
        container.innerHTML = '<tr><td colspan="6" class="text-gray-400 text-center py-4">No courses found.</td></tr>';
        return;
    }
    
   
    courses.forEach(c => {  // ← Changed from courses.slice(0, 8).forEach(c => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${c.icon || 'N/A'}</td>
            <td class="max-w-xs truncate">${c.title || 'N/A'}</td>
            <td class="max-w-xs truncate">${c.description || 'N/A'}</td>
            <td>${c.duration || 'N/A'}</td>
            <td>${c.level || 'N/A'}</td>
            <td class="flex space-x-2">
                <button class="btn-secondary text-xs" onclick='openCourseModal(${JSON.stringify(c).replace(/'/g, "\\'")})'>Edit</button>
                <button class="btn-danger text-xs" onclick="deleteCourse(${c.id})">Delete</button>
            </td>
        `;
        container.appendChild(row);
    });
}
        async function deleteCourse(id) {
            if (confirm('Delete this course?')) {
                try {
                    const response = await fetch(`${API_BASE}/api/courses/${id}`, { method: 'DELETE' });

                    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                    loadCourses();
                } catch(err) { 
                    console.error('Error deleting course:', err);
                    alert(`Failed to delete course: ${err.message}`);
                }
            }
        }

        // --- PARTNERS ---
        async function loadPartners() {
            try {
                console.log('Loading partners...');
                const res = await fetch(`${API_BASE}/api/partners`);

                if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
                const partners = await res.json();
                renderPartners(partners);
                document.getElementById('totalPartners').innerText = partners.length;
            } catch(err) { 
                console.error('Error loading partners:', err);
                document.getElementById('partnerList').innerHTML = `<p class="text-red-400">Error loading partners: ${err.message}</p>`;
            }
        }

        function openPartnerModal(partner = null) {
            const modal = document.getElementById('partnerModal');
            modal.classList.remove('admin-hidden');
            const form = document.getElementById('partnerForm');
            if (partner) {
                document.getElementById('partnerIndex').value = partner.id;
                document.getElementById('partnerAlt').value = partner.name || '';
                // No need to set file input value; it’s read-only until a new file is selected
            } else {
                form.reset();
                document.getElementById('partnerIndex').value = '';
            }
        }

        function closePartnerModal() {
            document.getElementById('partnerModal').classList.add('admin-hidden');
        }

        document.getElementById('partnerForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const submitBtn = this.querySelector('button[type="submit"]');
    submitBtn.disabled = true;

    try {
        const formData = new FormData();
        
        const name = document.getElementById('partnerAlt').value;
        const logoFile = document.getElementById('partnerSrc').files[0];
        
        if (!name) throw new Error('Partner name is required');
        if (!logoFile) throw new Error('Logo file is required');

        formData.append('name', name);
        formData.append('logo', logoFile);

        console.log('Submitting partner:', {
            name: formData.get('name'),
            logo: formData.get('logo').name
        });

const response = await fetch(`${API_BASE}/api/partners`, { 
  // options here

            method: 'POST',
            body: formData
        });

        const data = await response.json();
        
        if (!response.ok) {
            throw new Error(data.error || data.details || 'Failed to create partner');
        }

        alert('Partner added successfully!');
        this.reset();
        closePartnerModal();
        loadPartners();

    } catch (err) {
        console.error('Partner creation error:', err);
        alert(err.message || 'Failed to create partner');
    } finally {
        submitBtn.disabled = false;
    }
});

        function renderPartners(partners) {
    const container = document.getElementById('partnerList');
    container.innerHTML = '';
    if (partners.length === 0) {
        container.innerHTML = '<p class="text-gray-400">No partners found.</p>';
        return;
    }
partners.forEach(p => {
        const div = document.createElement('div');
        div.className = 'item-row';
        div.innerHTML = `
           <span>
  <strong>${p.name}</strong> - 
  <img 
    src="${
      /^https?:\/\//.test(p.logo_url)
        ? p.logo_url
        : `${window.location.origin}${p.logo_url?.startsWith('/') ? p.logo_url : '/' + p.logo_url}`
    }" 
    alt="${p.name}" 
    style="height:50px; border-radius:5px; margin-top:5px;" 
    onerror="this.src='https://placehold.co/150x80?text=Image+Not+Found'"
  >
</span>
<span>
  <button class="btn-secondary mr-2" onclick='openPartnerModal(${JSON.stringify(p)})'>Edit</button>
  <button class="btn-danger" onclick="deletePartner(${p.id})">Delete</button>
</span>

        `;
        container.appendChild(div);
    });
}
        async function deletePartner(id) {
            if (confirm('Delete this partner?')) {
                try {
                    const response = await fetch(`${API_BASE}/api/partners/${id}`, { method: 'DELETE' });

                    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                    loadPartners();
                } catch(err) { 
                    console.error('Error deleting partner:', err);
                    alert(`Failed to delete partner: ${err.message}`);
                }
            }
        }

        // --- SUCCESS STORIES ---
        async function loadStories() {
            try {
                const res = await fetch(`${API_BASE}/api/success_stories`);

             if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
                const stories = await res.json();
                renderStories(stories);
                document.getElementById('totalStories').innerText = stories.length;
            } catch(err) { 
                console.error('Error loading stories:', err);
                document.getElementById('storyList').innerHTML = `<p class="text-red-400">Error loading stories: ${err.message}</p>`;
            }
        }

        function openStoryModal(story = null) {
            const modal = document.getElementById('storyModal');
            modal.classList.remove('admin-hidden');
            if (story) {
                document.getElementById('storyIndex').value = story.id;
                document.getElementById('storyQuote').value = story.quote;
                document.getElementById('storyName').value = story.name;
                document.getElementById('storyRole').value = story.role;
                document.getElementById('storyCompany').value = story.company;
                document.getElementById('storyRating').value = story.rating;
            } else { 
                document.getElementById('storyForm').reset(); 
                document.getElementById('storyIndex').value = ''; 
            }
        }

        function closeStoryModal() { 
            document.getElementById('storyModal').classList.add('admin-hidden'); 
        }

        document.getElementById('storyForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const id = document.getElementById('storyIndex').value;
            const formData = new FormData();
            formData.append('quote', document.getElementById('storyQuote').value);
            formData.append('name', document.getElementById('storyName').value);
            formData.append('role', document.getElementById('storyRole').value);
            formData.append('company', document.getElementById('storyCompany').value);
            formData.append('rating', document.getElementById('storyRating').value);
            const imageFile = document.getElementById('storyImageFile').files[0];
            if (imageFile) formData.append('image', imageFile);
            try {
                const response = await fetch(
  id ? `${API_BASE}/api/success_stories/${id}` : `${API_BASE}/api/success_stories`,
  {
    // options...
                  method: id ? 'PUT' : 'POST',
                    body: formData
                });
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                closeStoryModal();
                loadStories();
            } catch (err) {
                console.error('Error saving story:', err);
                alert(`Failed to save story: ${err.message}`);
            }
        });

       function renderStories(stories) {
    const container = document.getElementById('storyList');
    if (!container) return;

    container.innerHTML = '';

    if (stories.length === 0) {
        container.innerHTML = '<p class="text-gray-400 text-center py-4">No success stories found.</p>';
        return;
    }

    stories.forEach(s => {
        const div = document.createElement('div');
        div.className = 'item-row';
        // Use s.image for the image path
        // If s.image starts with http, use as is; else prefix with backend URL
        let imgSrc = s.image
            ? (/^https?:\/\//.test(s.image) ? s.image : `${API_BASE}${s.image.startsWith('/') ? s.image : '/' + s.image}`)
            : '';
        div.innerHTML = `
            <span class="flex-1">
                <strong>${s.name || 'Unknown'}</strong> - ${s.role || 'N/A'} at ${s.company || 'N/A'} 
                (Rating: ${s.rating || 'N/A'})<br>
                ${imgSrc ? `<img src="${imgSrc}" alt="${s.name}" 
                     class="h-12 rounded mt-2" onerror="this.style.display='none'">` : ''}
            </span>
            <span class="flex space-x-2">
                <button class="btn-secondary text-xs edit-story-btn">Edit</button>
                <button class="btn-danger text-xs delete-story-btn">Delete</button>
            </span>
        `;
        div.querySelector('.edit-story-btn').addEventListener('click', () => openStoryModal(s));
        div.querySelector('.delete-story-btn').addEventListener('click', () => deleteStory(s.id));
        container.appendChild(div);
    });
}

        async function deleteStory(id) {
            if (confirm('Delete this story?')) {
                try {
                    const response = await fetch(`${API_BASE}/api/success_stories/${id}`, {
  method: 'DELETE'
});

                    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                    loadStories();
                } catch(err) { 
                        console.error('Error deleting story:', err);
                    alert(`Failed to delete story: ${err.message}`);
                }
            }
        }

        // --- USERS ---
        // Download CV function
        async function downloadCV(userId, userName) {
            try {
                // Use the correct endpoint for registrations
                const link = document.createElement('a');
                link.href = `${API_BASE}/api/registrations/${userId}/cv`;
                link.download = `${userName.replace(/[^a-zA-Z0-9.-]/g, '_')}_CV.pdf`;
                link.target = '_blank';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                console.error('Error downloading CV:', error);
                alert('Failed to download CV. Please try again.');
            }
        }

        // CV Preview function
        function previewCV(userId, userName) {
            try {
                const modal = document.getElementById('cvPreviewModal');
                const title = document.getElementById('cvPreviewTitle');
                const frame = document.getElementById('cvPreviewFrame');
                const error = document.getElementById('cvPreviewError');
                const downloadBtn = document.getElementById('cvDownloadFromPreview');
                
                // Set title and download button
                title.textContent = `CV Preview - ${userName}`;
                downloadBtn.onclick = () => downloadCV(userId, userName);
                
                // Show modal
                modal.classList.remove('admin-hidden');
                
                // Load CV in iframe
                const previewUrl = `${API_BASE}/api/registrations/${userId}/cv/preview`;
                frame.src = previewUrl;
                frame.style.display = 'block';
                error.classList.add('hidden');
                
                // Handle iframe load errors
                frame.onload = function() {
                    console.log('CV preview loaded successfully');
                };
                
                frame.onerror = function() {
                    console.error('Failed to load CV preview');
                    frame.style.display = 'none';
                    error.classList.remove('hidden');
                };
                
            } catch (error) {
                console.error('Error opening CV preview:', error);
                alert('Failed to open CV preview. Please try again.');
            }
        }
        
        function closeCVPreview() {
            const modal = document.getElementById('cvPreviewModal');
            const frame = document.getElementById('cvPreviewFrame');
            
            modal.classList.add('admin-hidden');
            frame.src = ''; // Clear iframe to stop loading
        }

        // Notification System
        function showNotification(message, type = 'info', duration = 5000) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            
            const icons = {
                success: '✓',
                error: '✕',
                warning: '⚠',
                info: 'ℹ'
            };
            
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <div class="notification-icon">
                        ${icons[type] || icons.info}
                    </div>
                    <div class="flex-1">
                        <p class="text-white font-medium">${message}</p>
                        <p class="text-gray-400 text-sm">${new Date().toLocaleTimeString()}</p>
                    </div>
                    <button onclick="removeNotification(this.parentElement)" class="text-gray-400 hover:text-white ml-3">
                        ✕
                    </button>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Trigger animation
            setTimeout(() => notification.classList.add('show'), 100);
            
            // Auto remove
            setTimeout(() => removeNotification(notification), duration);
            
            return notification;
        }
        
        function removeNotification(notification) {
            if (notification && notification.parentElement) {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.parentElement.removeChild(notification);
                    }
                }, 300);
            }
        }
        
        // User count monitoring for notifications
        let lastUserCount = 0;
        
        function checkForNewRegistrations() {
            fetch(`${API_BASE}/api/users`)
                .then(response => response.json())
                .then(users => {
                    const currentCount = users.length;
                    if (lastUserCount > 0 && currentCount > lastUserCount) {
                        const newUsers = currentCount - lastUserCount;
                        showNotification(
                            `${newUsers} new registration${newUsers > 1 ? 's' : ''} received!`, 
                            'success'
                        );
                        
                        // Update the user counts immediately
                        document.getElementById('totalUsers').innerText = currentCount;
                        const totalUsersDisplay = document.getElementById('totalUsersDisplay');
                        if (totalUsersDisplay) {
                            totalUsersDisplay.innerText = currentCount;
                        }
                    }
                    lastUserCount = currentCount;
                })
                .catch(err => {
                    console.error('Error checking registrations:', err);
                });
        }

        async function fetchUsers() {
            try {
                const res = await fetch(`${API_BASE}/api/users`);

                if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
                const users = await res.json();
                renderUsers(users);
                
                // Update both total user displays
                const userCount = users.length;
                document.getElementById('totalUsers').innerText = userCount;
                const totalUsersDisplay = document.getElementById('totalUsersDisplay');
                if (totalUsersDisplay) {
                    totalUsersDisplay.innerText = userCount;
                }
            } catch(err) {
                console.error('Error fetching users:', err);
                document.getElementById('userList').innerHTML = `<tr><td colspan="5" class="text-red-400">Error loading users: ${err.message}. Check backend connection.</td></tr>`;
            }
        }

        function renderUsers(users) {
            const container = document.getElementById('userList');
            container.innerHTML = '';
            if (users.length === 0) { 
                container.innerHTML = '<tr><td colspan="5" class="text-gray-400">No registered users found.</td></tr>'; 
                return; 
            }
            users.forEach(u => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${u.full_name}</td>
                    <td>${u.email}</td>
                    <td>${u.roles || 'N/A'}</td>
                    <td>${u.phone || 'N/A'}</td>
                    <td>
        ${u.cv_url
        ? `<button onclick="downloadCV(${u.id}, '${u.full_name}')" class="text-blue-400 hover:text-blue-300 hover:underline font-medium bg-transparent border-none cursor-pointer">
            📥 Download CV
          </button>`
        : '<span class="text-gray-500">No CV</span>'
      }

                    </td>
                `;

                
                container.appendChild(row);
            });
        }

        // --- CONSULTATIONS ---
       // In admin-dashboard.html, update the loadConsultations function:
async function loadConsultations() {
    try {
        // Use the full URL to your Render backend
        const API_BASE = 'https://talentconnects.onrender.com';
        const response = await fetch(`${API_BASE}/api/consultations`, {
            credentials: 'include' // Important for cookies if using sessions
        });
        
        if (!response.ok) {
            const error = await response.json().catch(() => ({}));
            throw new Error(error.error || `HTTP error! Status: ${response.status}`);
        }
        
        const data = await response.json();
        console.log('Loaded consultations:', data);
        
        // Update the UI with the data
        renderConsultations(data);
        document.getElementById('totalConsultations').innerText = data.length || 0;
        
        return data;
    } catch (error) {
        console.error('Error loading consultations:', error);
        const container = document.getElementById('consultationList');
        if (container) {
            container.innerHTML = '<tr><td colspan="8" class="text-red-400">Error loading consultations: ' + 
                                error.message + '</td></tr>';
        }
        showNotification('Error loading consultations: ' + error.message, 'error');
        throw error;
    }
}

        function renderConsultations(consultations) {
            const container = document.getElementById('consultationList');
            container.innerHTML = '';
            
            if (consultations.length === 0) {
                container.innerHTML = '<tr><td colspan="8" class="text-gray-400 text-center py-8">No consultation bookings yet</td></tr>';
                return;
            }
            
            consultations.forEach(consultation => {
                const row = document.createElement('tr');
                const meetingDate = new Date(consultation.meeting_date).toLocaleDateString();
                const bookedDate = new Date(consultation.created_at).toLocaleDateString();
                
                // Status badge styling
                const statusColors = {
                    'pending': 'bg-yellow-600/20 text-yellow-400 border-yellow-600/30',
                    'confirmed': 'bg-green-600/20 text-green-400 border-green-600/30',
                    'completed': 'bg-blue-600/20 text-blue-400 border-blue-600/30',
                    'cancelled': 'bg-red-600/20 text-red-400 border-red-600/30'
                };
                
                row.innerHTML = `
                    <td>${consultation.full_name}</td>
                    <td>${consultation.email}</td>
                    <td>${consultation.phone}</td>
                    <td>${meetingDate}</td>
                    <td>${consultation.meeting_time}</td>
                    <td>
                        <span class="px-2 py-1 rounded-full text-xs border ${statusColors[consultation.status] || statusColors.pending}">
                            ${consultation.status.charAt(0).toUpperCase() + consultation.status.slice(1)}
                        </span>
                    </td>
                    <td>${bookedDate}</td>
                    <td>
                        <select onchange="updateConsultationStatus(${consultation.id}, this.value)" class="bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm text-white">
                            <option value="pending" ${consultation.status === 'pending' ? 'selected' : ''}>Pending</option>
                            <option value="confirmed" ${consultation.status === 'confirmed' ? 'selected' : ''}>Confirmed</option>
                            <option value="completed" ${consultation.status === 'completed' ? 'selected' : ''}>Completed</option>
                            <option value="cancelled" ${consultation.status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                        </select>
                    </td>
                `;
                
                container.appendChild(row);
            });
        }

        async function updateConsultationStatus(consultationId, newStatus) {
            try {
                const response = await fetch(`${API_BASE}/api/consultations/${consultationId}/status`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ status: newStatus })
                });
                
                if (response.ok) {
                    showNotification(`Consultation status updated to ${newStatus}`, 'success');
                    loadConsultations(); // Reload to reflect changes
                } else {
                    throw new Error('Failed to update status');
                }
            } catch (error) {
                console.error('Error updating consultation status:', error);
                showNotification('Failed to update consultation status', 'error');
                loadConsultations(); // Reload to reset the dropdown
            }
        }

        // --- UPDATE LAST UPDATED TIME ---
        function updateLastUpdated() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true 
            });
            const dateString = now.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric' 
            });
            document.getElementById('lastUpdated').textContent = `${timeString} on ${dateString}`;
        }

        // --- ENHANCED TAB SWITCHING ---
        function showTab(tab, event) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            if (event) event.currentTarget.classList.add('active');
            
            // Update last updated time
            updateLastUpdated();
            
            // Load data for specific tabs
            if (tab === 'users') fetchUsers();
            if (tab === 'courses') loadCourses();
            if (tab === 'partners') loadPartners();
            if (tab === 'stories') loadStories();
            if (tab === 'siteStats') loadSiteStats();
        }

        // --- INITIALIZE ---
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
            updateLastUpdated();
            // Update time every minute
            setInterval(updateLastUpdated, 60000);
        });
    </script>
</body>
</html>